<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Folgas e Férias - Mercado Livre</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ESTILOS GERAIS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
            background-image: linear-gradient(to bottom, #f5f7fa, #e4e8f0);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        /* HEADER */
        .header {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #ffde00, #ffe958);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
            border-left: 8px solid #2d3277;
        }
        
        .header h1 {
            color: #2d3277;
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .header p {
            color: #555;
            font-size: 16px;
            font-weight: 500;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .logo i {
            font-size: 28px;
            color: #2d3277;
        }
        
        /* CARDS */
        .card {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
        }
        
        .card-title {
            color: #2d3277;
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ffde00;
        }
        
        /* FORMULÁRIOS */
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #444;
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #2d3277;
            box-shadow: 0 0 0 2px rgba(45, 50, 119, 0.1);
        }
        
        /* TIPO DE SOLICITAÇÃO */
        .tipo-solicitacao {
            display: flex;
            gap: 15px;
            margin-top: 10px;
        }
        
        .tipo-opcao {
            flex: 1;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .tipo-opcao:hover {
            border-color: #ffde00;
            background-color: #fffef5;
        }
        
        .tipo-opcao.ativo {
            border-color: #2d3277;
            background-color: #f0f2ff;
        }
        
        .tipo-opcao h3 {
            color: #2d3277;
            margin-bottom: 5px;
            font-size: 18px;
        }
        
        .tipo-opcao p {
            color: #666;
            font-size: 14px;
        }
        
        /* TABELAS */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: #f8f9fa;
            color: #2d3277;
            font-weight: 600;
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        .periodo-table {
            margin-top: 20px;
            width: 100%;
        }
        
        .periodo-table td {
            padding: 10px;
        }
        
        /* BOTÕES */
        .btn {
            background: linear-gradient(to right, #2d3277, #3a40a0);
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            background: linear-gradient(to right, #3a40a0, #4a52c0);
            transform: translateY(-2px);
            box-shadow: 0 5px 10px rgba(45, 50, 119, 0.2);
        }
        
        .btn-secondary {
            background: linear-gradient(to right, #6c757d, #868e96);
            margin-top: 15px;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(to right, #868e96, #9fa4aa);
        }
        
        /* CALENDÁRIO */
        .calendario {
            background-color: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            height: fit-content;
        }
        
        .calendario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .calendario-mes {
            font-size: 22px;
            font-weight: 700;
            color: #2d3277;
        }
        
        .calendario-navegacao button {
            background-color: #f0f2ff;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            color: #2d3277;
            font-weight: bold;
            font-size: 18px;
            margin-left: 5px;
        }
        
        .dias-semana {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            font-weight: 600;
            color: #666;
            margin-bottom: 10px;
        }
        
        .dias-calendario {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }
        
        .dia {
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            font-weight: 500;
            font-size: 14px;
            border: 1px solid #eee;
        }
        
        .dia:hover {
            background-color: #f0f2ff;
            transform: scale(1.05);
        }
        
        .dia.atual {
            background-color: #ffde00;
            font-weight: bold;
        }
        
        .dia.feriado {
            background-color: #fff0f0;
            color: #d32f2f;
            font-weight: bold;
        }
        
        .dia.limite-atingido {
            background-color: #ffcccc;
            color: #721c24;
            font-weight: bold;
            border: 2px solid #dc3545;
        }
        
        .dia.com-colaboradores {
            background-color: #e0ffe0;
            color: #155724;
        }
        
        /* CONTADOR E NOMES NO CALENDÁRIO */
        .contador-dia {
            position: absolute;
            top: 2px;
            right: 2px;
            background-color: #2d3277;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        
        .nome-colaborador {
            position: absolute;
            bottom: 2px;
            left: 2px;
            right: 2px;
            font-size: 9px;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #2d3277;
            font-weight: bold;
            background: rgba(255, 255, 255, 0.8);
            padding: 1px;
            border-radius: 3px;
        }
        
        /* INFORMAÇÕES */
        .info-box {
            background-color: #f0f2ff;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #2d3277;
        }
        
        .info-title {
            color: #2d3277;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .info-item {
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* STATUS */
        .status {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-pendente {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-aprovado {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-rejeitado {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        /* AÇÕES NA TABELA */
        .acoes {
            display: flex;
            gap: 10px;
        }
        
        .btn-acao {
            padding: 6px 12px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.2s;
        }
        
        .btn-editar {
            background-color: #e3f2fd;
            color: #1565c0;
        }
        
        .btn-editar:hover {
            background-color: #bbdefb;
            transform: translateY(-1px);
        }
        
        .btn-excluir {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .btn-excluir:hover {
            background-color: #ffcdd2;
            transform: translateY(-1px);
        }
        
        /* MENSAGENS */
        .sem-solicitacoes {
            text-align: center;
            padding: 30px;
            color: #777;
            font-style: italic;
        }
        
        .search-box {
            margin-bottom: 20px;
        }
        
        /* RESPONSIVIDADE */
        @media (max-width: 992px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .tipo-solicitacao {
                flex-direction: column;
            }
            
            .calendario {
                order: 3;
            }
        }
        
        /* UTILITÁRIOS */
        .hidden {
            display: none !important;
        }
        
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* POPUPS */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .popup-overlay.active {
            display: flex;
        }
        
        .popup {
            background: white;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            animation: popupAppear 0.3s ease-out;
        }
        
        @keyframes popupAppear {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .popup-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #ffde00;
        }
        
        .popup-icon {
            background: #2d3277;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .popup-title {
            color: #2d3277;
            font-size: 22px;
            margin: 0;
        }
        
        .popup-summary {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .summary-label {
            font-weight: 600;
            color: #555;
        }
        
        .summary-value {
            color: #2d3277;
            font-weight: 600;
        }
        
        .popup-footer {
            display: flex;
            gap: 15px;
            justify-content: flex-end;
            margin-top: 25px;
        }
        
        .btn-popup {
            padding: 12px 25px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            min-width: 120px;
            transition: all 0.3s;
        }
        
        .btn-cancelar {
            background: #f8f9fa;
            color: #6c757d;
            border: 1px solid #dee2e6;
        }
        
        .btn-cancelar:hover {
            background: #e9ecef;
        }
        
        .btn-confirmar {
            background: linear-gradient(to right, #2d3277, #3a40a0);
            color: white;
        }
        
        .btn-confirmar:hover {
            background: linear-gradient(to right, #3a40a0, #4a52c0);
            transform: translateY(-2px);
        }
        
        .success-message {
            text-align: center;
            padding: 20px;
        }
        
        .success-icon {
            font-size: 60px;
            color: #28a745;
            margin-bottom: 20px;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #dc3545;
            display: none;
        }
        
        .warning-message {
            background: #fff3cd;
            color: #856404;
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #ffc107;
        }
        
        .feriado-info {
            background: #e8f4fd;
            color: #0c5460;
            padding: 8px 12px;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* LEGENDA DO CALENDÁRIO */
        .legenda-calendario {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .legenda-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 12px;
        }
        
        .legenda-cor {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        /* NOVO ESTILO PARA CALENDÁRIO COM FERIADOS */
        .dia-nacional {
            background-color: #ffe6e6;
            border-left: 3px solid #dc3545;
        }
        
        .dia-municipal {
            background-color: #fff0e6;
            border-left: 3px solid #fd7e14;
        }
        
        .calendario-feriados {
            margin-top: 15px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .calendario-feriados h4 {
            color: #2d3277;
            margin-bottom: 10px;
            font-size: 14px;
        }
        
        .feriado-lista {
            display: flex;
            flex-direction: column;
            gap: 5px;
            font-size: 12px;
        }
        
        .feriado-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px;
        }
        
        .feriado-cor {
            width: 12px;
            height: 12px;
            border-radius: 2px;
        }
        
        .cor-nacional {
            background-color: #dc3545;
        }
        
        .cor-municipal {
            background-color: #fd7e14;
        }
        
        /* POPUP DE LIMITE EXCEDIDO */
        .limite-popup {
            max-width: 600px;
        }
        
        .lista-colaboradores {
            max-height: 200px;
            overflow-y: auto;
            margin: 15px 0;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .colaborador-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #eee;
        }
        
        .colaborador-item:last-child {
            border-bottom: none;
        }
        
        /* GESTOR SELECT */
        .gestor-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }
        
        .gestor-option {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .gestor-option:hover {
            border-color: #ffde00;
            background-color: #fffef5;
        }
        
        .gestor-option.ativo {
            border-color: #2d3277;
            background-color: #f0f2ff;
        }
        
        .gestor-info {
            flex: 1;
        }
        
        .gestor-nome {
            font-weight: 600;
            color: #2d3277;
            margin-bottom: 2px;
        }
        
        .gestor-email {
            font-size: 12px;
            color: #666;
        }
        
        .gestor-tipo {
            font-size: 11px;
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            color: #495057;
        }
        
        /* BOTÃO CANCELAR EDIÇÃO */
        .btn-cancelar-edicao {
            background: linear-gradient(to right, #dc3545, #e35d6a);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn-cancelar-edicao:hover {
            background: linear-gradient(to right, #e35d6a, #ea868f);
            transform: translateY(-2px);
        }
        
        /* DETALHES DA SOLICITAÇÃO */
        .detalhes-solicitacao {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #2d3277;
        }
        
        .info-detalhes {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding-bottom: 8px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .info-detalhes-label {
            font-weight: 600;
            color: #555;
        }
        
        .info-detalhes-valor {
            color: #2d3277;
            font-weight: 500;
        }
        
        /* POPUP DE SUCESSO APRIMORADO */
        .popup-sucesso-conteudo {
            text-align: center;
            padding: 20px;
        }
        
        .sucesso-titulo {
            color: #28a745;
            margin-bottom: 20px;
            font-size: 24px;
        }
        
        .sucesso-info {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }
        
        .sucesso-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }
        
        .sucesso-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .sucesso-label {
            font-weight: 600;
            color: #555;
        }
        
        .sucesso-valor {
            color: #2d3277;
            font-weight: 600;
        }

/* ESTILOS DO RODAPÉ */
.footer {
    grid-column: 1 / -1;
    background: linear-gradient(135deg, #2d3277, #3a40a0);
    color: white;
    padding: 40px 25px 20px;
    border-radius: 12px;
    margin-top: 30px;
    box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
    border-top: 8px solid #ffde00;
}

.footer-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 30px;
    max-width: 1200px;
    margin: 0 auto;
}

.footer-section {
    padding: 10px;
}

.footer-logo {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
}

.footer-logo i {
    font-size: 24px;
    color: #ffde00;
}

.footer-title {
    font-size: 18px;
    font-weight: 600;
    color: #ffde00;
}

.footer-description {
    font-size: 14px;
    color: #d0d0ff;
    line-height: 1.5;
    margin-top: 10px;
}

.footer-heading {
    font-size: 16px;
    font-weight: 600;
    color: #ffde00;
    margin-bottom: 15px;
    padding-bottom: 8px;
    border-bottom: 2px solid rgba(255, 222, 0, 0.3);
}

.footer-links {
    list-style: none;
    padding: 0;
    margin: 0;
}

.footer-links li {
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.footer-links i {
    color: #ffde00;
    font-size: 14px;
    width: 20px;
}

.footer-links a {
    color: #d0d0ff;
    text-decoration: none;
    transition: color 0.3s;
    font-size: 14px;
}

.footer-links a:hover {
    color: #ffde00;
    text-decoration: underline;
}

.dev-info {
    font-size: 13px;
    color: #d0d0ff;
}

.dev-info p {
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.dev-info i {
    color: #ffde00;
    width: 16px;
}

.version {
    background: rgba(255, 222, 0, 0.1);
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    display: inline-block;
    margin-top: 5px;
    border: 1px solid rgba(255, 222, 0, 0.3);
}

.footer-bottom {
    margin-top: 40px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    text-align: center;
}

.footer-copyright p {
    color: #b0b0ff;
    font-size: 12px;
    margin-bottom: 5px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    flex-wrap: wrap;
}

.footer-copyright i {
    color: #ffde00;
    font-size: 11px;
}

.footer-copyright p:last-child {
    margin-top: 15px;
    font-size: 11px;
    color: #9090cc;
}

/* RESPONSIVIDADE DO RODAPÉ */
@media (max-width: 768px) {
    .footer {
        padding: 30px 15px 15px;
    }
    
    .footer-content {
        grid-template-columns: 1fr;
        gap: 20px;
    }
    
    .footer-copyright p {
        flex-direction: column;
        gap: 8px;
    }
    
    .footer-section {
        padding: 0;
    }
}

    </style>

</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <div class="logo">
                <i class="fas fa-calendar-alt"></i>
                <div>
                    <h1>Sistema de Folgas e Férias</h1>
                    <p>Mercado Livre • BRSP15 • Controle de Ausências 2026</p>
                </div>
            </div>
        </div>
        
        <!-- FORMULÁRIO DE SOLICITAÇÃO -->
        <div class="card">
            <h2 class="card-title">Solicitar Folga ou Férias</h2>
            
            <div class="form-group">
                <label for="matricula">SUA MATRÍCULA</label>
                <input type="text" id="matricula" placeholder="Ex: Sua Matrícula Aqui" required>
            </div>
            
            <div class="form-group">
                <label for="nome">NOME COMPLETO</label>
                <input type="text" id="nome" placeholder="Seu nome completo" required>
            </div>
            
            <div class="form-group">
                <label for="gestor">GESTOR RESPONSÁVEL</label>
                <div class="gestor-options">
                    <div class="gestor-option ativo" id="gestor-eliane">
                        <div class="gestor-info">
                            <div class="gestor-nome">Eliane E. Barbosa</div>
                            <div class="gestor-email">eliane.ebarbosa@mercadolivre.com</div>
                        </div>
                        <div class="gestor-tipo">Gestor Teste</div>
                    </div>
                    <div class="gestor-option" id="gestor-gabriel">
                        <div class="gestor-info">
                            <div class="gestor-nome">Gabriel G. Paiva</div>
                            <div class="gestor-email">gabriel.gpaiva@mercadolivre.com</div>
                        </div>
                        <div class="gestor-tipo">Gestor Operacional</div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>TIPO DE SOLICITAÇÃO</label>
                <div class="tipo-solicitacao">
                    <div class="tipo-opcao ativo" id="tipo-folga">
                        <h3>Folga</h3>
                        <p>Período de 1 a 7 dias</p>
                    </div>
                    <div class="tipo-opcao" id="tipo-ferias">
                        <h3>Férias</h3>
                        <p>Período de 5 a 30 dias</p>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>PERÍODO DESEJADO</label>
                <table class="periodo-table">
                    <tr>
                        <td><label for="data-inicial">Data Inicial</label></td>
                        <td><label for="data-final">Data Final</label></td>
                    </tr>
                    <tr>
                        <td><input type="date" id="data-inicial" required></td>
                        <td><input type="date" id="data-final" required></td>
                    </tr>
                </table>
            </div>
            
            <div class="feriado-info">
                <i class="fas fa-info-circle"></i>
                <span>Agendamento permitido em feriados. Limite de 3 colaboradores por dia (exceto feriados).</span>
            </div>
            
            <button class="btn" id="btn-solicitar">
                <i class="fas fa-paper-plane"></i> Enviar Solicitação
            </button>
            <button class="btn btn-secondary" id="btn-limpar">
                <i class="fas fa-broom"></i> Limpar Formulário
            </button>
            
            <!-- Área para botão cancelar edição -->
            <div id="area-cancelar-edicao"></div>
        </div>
        
        <!-- MINHAS SOLICITAÇÕES -->
        <div class="card">
            <h2 class="card-title">Minhas Solicitações</h2>
            
            <div class="search-box">
                <label for="busca-solicitacao">Buscar por matrícula:</label>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <input type="text" id="busca-solicitacao" placeholder="Digite sua matrícula (ex: Sua Matrícula Aqui)" style="flex: 1;">
                    <button class="btn" id="btn-buscar" style="width: auto; min-width: 120px; margin-top: 0;">
                        <i class="fas fa-search"></i> Buscar
                    </button>
                </div>
                <div style="margin-top: 10px; font-size: 12px; color: #666;">
                    <i class="fas fa-info-circle"></i> Digite sua matrícula exatamente como está na planilha
                </div>
            </div>
            
            <div id="solicitacoes-container">
                <div class="sem-solicitacoes" id="sem-solicitacoes">
                    <i class="fas fa-search" style="font-size: 48px; margin-bottom: 15px; color: #ccc;"></i>
                    <p>Digite sua matrícula e clique em "Buscar" para visualizar suas solicitações.</p>
                </div>
                
                <table id="tabela-solicitacoes" class="hidden">
                    <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>Período</th>
                            <th>Dias</th>
                            <th>Status</th>
                            <th>Resolução</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="corpo-tabela-solicitacoes">
                        <!-- As linhas serão preenchidas via JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- CALENDÁRIO -->
        <div class="calendario">
            <div class="calendario-header">
                <div class="calendario-mes" id="mes-atual">Janeiro 2026</div>
                <div class="calendario-navegacao">
                    <button id="btn-mes-anterior"><i class="fas fa-chevron-left"></i></button>
                    <button id="btn-mes-seguinte"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
            
            <div class="dias-semana">
                <div>Dom</div>
                <div>Seg</div>
                <div>Ter</div>
                <div>Qua</div>
                <div>Qui</div>
                <div>Sex</div>
                <div>Sáb</div>
            </div>
            
            <div class="dias-calendario" id="calendario">
                <!-- Os dias serão gerados via JavaScript -->
            </div>
            
            <!-- LEGENDA DO CALENDÁRIO -->
            <div class="legenda-calendario">
                <div class="legenda-item">
                    <div class="legenda-cor" style="background-color: #ffe6e6;"></div>
                    <span>Feriado Nacional</span>
                </div>
                <div class="legenda-item">
                    <div class="legenda-cor" style="background-color: #fff0e6;"></div>
                    <span>Feriado Municipal</span>
                </div>
                <div class="legenda-item">
                    <div class="legenda-cor" style="background-color: #e0ffe0;"></div>
                    <span>Com colaboradores</span>
                </div>
                <div class="legenda-item">
                    <div class="legenda-cor" style="background-color: #ffcccc;"></div>
                    <span>Limite atingido (3)</span>
                </div>
                <div class="legenda-item">
                    <div class="legenda-cor" style="background-color: #ffde00;"></div>
                    <span>Dia atual</span>
                </div>
            </div>
            
            <!-- LISTA DE FERIADOS DO MÊS -->
            <div class="calendario-feriados" id="feriados-mes">
                <h4><i class="fas fa-calendar-day"></i> Feriados deste mês:</h4>
                <div class="feriado-lista" id="lista-feriados">
                    <!-- Lista de feriados será preenchida via JavaScript -->
                </div>
            </div>
            
            <!-- INFORMAÇÕES -->
            <div class="info-box">
                <div class="info-title">
                    <i class="fas fa-info-circle"></i>
                    Informações do Sistema
                </div>
                
                <div class="info-item">
                    <i class="fas fa-calendar-check" style="color: #2d3277;"></i>
                    <div>
                        <strong>Limite por dia</strong>
                        <p>Máximo 3 colaboradores por dia (feriados ilimitados)</p>
                    </div>
                </div>
                
                <div class="info-item">
                    <i class="fas fa-bell" style="color: #2d3277;"></i>
                    <div>
                        <strong>Notificação</strong>
                        <p>E-mail automático ao registrar solicitação</p>
                    </div>
                </div>
                
                <div class="info-item">
                    <i class="fas fa-edit" style="color: #2d3277;"></i>
                    <div>
                        <strong>Edição/Exclusão</strong>
                        <p>Permitido apenas para status "Pendente"</p>
                    </div>
                </div>
                
                <div class="info-item">
                    <i class="fas fa-calendar-alt" style="color: #2d3277;"></i>
                    <div>
                        <strong>Feriados 2026</strong>
                        <p>Nacionais + Municipais de Cajamar-SP</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- POPUP DE CONFIRMAÇÃO -->
    <div class="popup-overlay" id="popup-confirmacao">
        <div class="popup">
            <div class="popup-header">
                <div class="popup-icon">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <h3 class="popup-title">Confirmar Solicitação</h3>
            </div>
            
            <div class="popup-summary" id="popup-summary">
                <!-- Resumo será preenchido aqui -->
            </div>
            
            <div class="warning-message">
                <i class="fas fa-exclamation-triangle"></i>
                <strong>Atenção:</strong> Após o envio, sua solicitação será analisada pelo gestor da equipe.
                Você poderá editar/excluir apenas enquanto o status for "Pendente".
            </div>
            
            <div class="error-message" id="popup-error">
                <!-- Mensagens de erro aparecerão aqui -->
            </div>
            
            <div class="popup-footer">
                <button class="btn-popup btn-cancelar" id="btn-cancelar-popup">
                    <i class="fas fa-times"></i> Cancelar
                </button>
                <button class="btn-popup btn-confirmar" id="btn-confirmar-envio">
                    <i class="fas fa-paper-plane"></i> Confirmar
                </button>
            </div>
        </div>
    </div>

    <!-- POPUP DE SUCESSO (ATUALIZADO) -->
    <div class="popup-overlay" id="popup-sucesso">
        <div class="popup">
            <div class="popup-sucesso-conteudo">
                <div class="success-icon">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h3 class="sucesso-titulo">Sua solicitação foi enviada!</h3>
                
                <div class="sucesso-info" id="sucesso-info">
                    <!-- Informações de sucesso serão preenchidas aqui -->
                </div>
                
                <div class="warning-message" style="margin-top: 20px;">
                    <i class="fas fa-envelope"></i>
                    <strong>Confirmação por e-mail:</strong> Você receberá um e-mail com os detalhes da sua solicitação.
                </div>
                
                <button class="btn-popup btn-confirmar" id="btn-fechar-popup" style="margin-top: 25px;">
                    <i class="fas fa-check"></i> Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- POPUP DE LIMITE EXCEDIDO -->
    <div class="popup-overlay" id="popup-limite">
        <div class="popup limite-popup">
            <div class="popup-header">
                <div class="popup-icon" style="background-color: #dc3545;">
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
                <h3 class="popup-title">Limite de Colaboradores Atingido!</h3>
            </div>
            
            <div id="popup-limite-conteudo">
                <!-- Conteúdo do popup será preenchido aqui -->
            </div>
            
            <div class="popup-footer">
                <button class="btn-popup btn-cancelar" id="btn-fechar-limite">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
        </div>
    </div>

    <!-- POPUP DE DETALHES DA SOLICITAÇÃO -->
    <div class="popup-overlay" id="popup-detalhes">

        <div class="popup">
            <div class="popup-header">
                <div class="popup-icon" style="background-color: #2d3277;">
                    <i class="fas fa-info-circle"></i>
                </div>
                <h3 class="popup-title">Detalhes da Solicitação</h3>
            </div>
            
            <div id="popup-detalhes-conteudo">
                <!-- Detalhes serão preenchidos aqui -->
            </div>
            
            <div class="popup-footer">
                <button class="btn-popup btn-cancelar" id="btn-fechar-detalhes">
                    <i class="fas fa-times"></i> Fechar
                </button>
            </div>
        </div>
    </div>


    <!-- RODAPÉ DO SISTEMA -->
    <div class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <div class="footer-logo">
                    <i class="fas fa-calendar-alt"></i>
                    <div class="footer-title">Sistema de Folgas e Férias</div>
                </div>
                <p class="footer-description">
                    Sistema desenvolvido para controle de ausências da BRSP15 - Mercado Livre
                </p>
            </div>
            
            <div class="footer-section">
                <h4 class="footer-heading">Suporte</h4>
                <ul class="footer-links">
                    <li><i class="fas fa-envelope"></i> <a href="mailto:suporte.cajamar@mercadolivre.com">ideasp15@mercadolivre.com</a></li>
                    <li><i class="fas fa-phone"></i> (11) 11 99292-4746 </li>
                    <li><i class="fas fa-clock"></i> Segunda a Domingo: 24h</li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4 class="footer-heading">Gestores Responsáveis</h4>
                <ul class="footer-links">
                    <li><i class="fas fa-user-tie"></i> BRSP15</li>
                    <li><i class="fas fa-user-tie"></i> Time ID/EA </li>
                </ul>
            </div>
            
            <div class="footer-section">
                <h4 class="footer-heading">Desenvolvimento</h4>
                <div class="dev-info">
                    <p><strong>Time ID/EA</strong></p>
                    <p><i class="fas fa-code"></i> Autorª: Eliane ERB</p>
                    <p><i class="fas fa-copyright"></i> Mercado Livre - BRSP15 2026</p>
                    <p class="version">Versão: 2.0.1</p>
                </div>
            </div>
        </div>
        
        <div class="footer-bottom">
            <div class="footer-copyright">
                <p>
                    <i class="fas fa-lock"></i> Sistema seguro • 
                    <i class="fas fa-shield-alt"></i> Dados protegidos • 
                    <i class="fas fa-cloud"></i> Hospedado na Google Cloud
                </p>
                <p>© 2026 Mercado Livre - Todos os direitos reservados. Este sistema é de uso exclusivo dos colaboradores.</p>
            </div>
        </div>
    </div>

//rodapé acima---------------------------------


    <script>
        // VARIÁVEIS GLOBAIS
        let tipoSolicitacao = "Folga";
        let gestorSelecionado = "eliane.ebarbosa@mercadolivre.com";
        let dataAtual = new Date(2026, 0, 1);
        let solicitacoesUsuario = [];
        let feriadosDoMes = [];
        let colaboradoresPorData = {};
        let datasComLimite = [];
        
        // ELEMENTOS DO DOM
        const elementos = {
            // Formulário
            tipoFolga: document.getElementById('tipo-folga'),
            tipoFerias: document.getElementById('tipo-ferias'),
            gestorEliane: document.getElementById('gestor-eliane'),
            gestorGabriel: document.getElementById('gestor-gabriel'),
            matriculaInput: document.getElementById('matricula'),
            nomeInput: document.getElementById('nome'),
            dataInicialInput: document.getElementById('data-inicial'),
            dataFinalInput: document.getElementById('data-final'),
            btnSolicitar: document.getElementById('btn-solicitar'),
            btnLimpar: document.getElementById('btn-limpar'),
            areaCancelarEdicao: document.getElementById('area-cancelar-edicao'),
            
            // Busca
            btnBuscar: document.getElementById('btn-buscar'),
            buscaSolicitacaoInput: document.getElementById('busca-solicitacao'),
            tabelaSolicitacoes: document.getElementById('tabela-solicitacoes'),
            corpoTabelaSolicitacoes: document.getElementById('corpo-tabela-solicitacoes'),
            semSolicitacoes: document.getElementById('sem-solicitacoes'),
            
            // Calendário
            mesAtualElement: document.getElementById('mes-atual'),
            calendarioElement: document.getElementById('calendario'),
            btnMesAnterior: document.getElementById('btn-mes-anterior'),
            btnMesSeguinte: document.getElementById('btn-mes-seguinte'),
            listaFeriados: document.getElementById('lista-feriados'),
            feriadosMes: document.getElementById('feriados-mes'),
            
            // Popups
            popupConfirmacao: document.getElementById('popup-confirmacao'),
            popupSucesso: document.getElementById('popup-sucesso'),
            popupLimite: document.getElementById('popup-limite'),
            popupDetalhes: document.getElementById('popup-detalhes'),
            popupSummary: document.getElementById('popup-summary'),
            popupError: document.getElementById('popup-error'),
            popupLimiteConteudo: document.getElementById('popup-limite-conteudo'),
            popupDetalhesConteudo: document.getElementById('popup-detalhes-conteudo'),
            sucessoInfo: document.getElementById('sucesso-info'),
            btnCancelarPopup: document.getElementById('btn-cancelar-popup'),
            btnConfirmarEnvio: document.getElementById('btn-confirmar-envio'),
            btnFecharPopup: document.getElementById('btn-fechar-popup'),
            btnFecharLimite: document.getElementById('btn-fechar-limite'),
            btnFecharDetalhes: document.getElementById('btn-fechar-detalhes')
        };
        
        // INICIALIZAÇÃO
        document.addEventListener('DOMContentLoaded', function() {
            inicializarSistema();
        });
        
        // FUNÇÃO DE INICIALIZAÇÃO
        function inicializarSistema() {
            configurarDatas();
            configurarEventos();
            carregarCalendario();
        }
        
        // CONFIGURAR DATAS MÍNIMAS/MAXIMAS
        function configurarDatas() {
            const hoje = new Date(2026, 0, 1);
            const dataMinima = new Date(hoje);
            dataMinima.setDate(dataMinima.getDate() + 2);
            
            elementos.dataInicialInput.min = formatarDataParaInput(dataMinima);
            elementos.dataFinalInput.min = formatarDataParaInput(dataMinima);
            
            const dataMaxima = new Date(hoje);
            dataMaxima.setFullYear(dataMaxima.getFullYear() + 1);
            
            elementos.dataInicialInput.max = formatarDataParaInput(dataMaxima);
            elementos.dataFinalInput.max = formatarDataParaInput(dataMaxima);
        }
        
        // CONFIGURAR TODOS OS EVENTOS
        function configurarEventos() {
            // Seleção do tipo de solicitação
            elementos.tipoFolga.addEventListener('click', () => selecionarTipo('Folga'));
            elementos.tipoFerias.addEventListener('click', () => selecionarTipo('Férias'));
            
            // Seleção do gestor
            elementos.gestorEliane.addEventListener('click', () => selecionarGestor('eliane'));
            elementos.gestorGabriel.addEventListener('click', () => selecionarGestor('gabriel'));
            
            // Validação de datas
            elementos.dataInicialInput.addEventListener('change', validarDataInicial);
            elementos.dataFinalInput.addEventListener('change', validarDataFinal);
            
            // Botões principais
            elementos.btnSolicitar.addEventListener('click', validarEAbrirPopup);
            elementos.btnLimpar.addEventListener('click', limparFormulario);
            elementos.btnBuscar.addEventListener('click', buscarSolicitacoes);
            
            // Busca com Enter
            elementos.buscaSolicitacaoInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') buscarSolicitacoes();
            });
            
            // Navegação do calendário
            elementos.btnMesAnterior.addEventListener('click', () => {
                dataAtual.setMonth(dataAtual.getMonth() - 1);
                carregarCalendario();
            });
            
            elementos.btnMesSeguinte.addEventListener('click', () => {
                dataAtual.setMonth(dataAtual.getMonth() + 1);
                carregarCalendario();
            });
            
            // Eventos dos popups
            elementos.btnCancelarPopup.addEventListener('click', () => {
                elementos.popupConfirmacao.classList.remove('active');
            });
            
            elementos.btnConfirmarEnvio.addEventListener('click', enviarSolicitacao);
            
            elementos.btnFecharPopup.addEventListener('click', () => {
                elementos.popupSucesso.classList.remove('active');
            });
            
            elementos.btnFecharLimite.addEventListener('click', () => {
                elementos.popupLimite.classList.remove('active');
            });
            
            elementos.btnFecharDetalhes.addEventListener('click', () => {
                elementos.popupDetalhes.classList.remove('active');
            });
            
            // Fechar popups clicando fora
            [elementos.popupConfirmacao, elementos.popupSucesso, elementos.popupLimite, elementos.popupDetalhes].forEach(popup => {
                popup.addEventListener('click', (e) => {
                    if (e.target === popup) {
                        popup.classList.remove('active');
                    }
                });
            });
        }
        
        // SELEÇÃO DO TIPO DE SOLICITAÇÃO
        function selecionarTipo(tipo) {
            tipoSolicitacao = tipo;
            elementos.tipoFolga.classList.toggle('ativo', tipo === 'Folga');
            elementos.tipoFerias.classList.toggle('ativo', tipo === 'Férias');
            
            if (elementos.dataInicialInput.value && elementos.dataFinalInput.value) {
                ajustarPeriodoPorTipo();
            }
        }
        
        // SELEÇÃO DO GESTOR
        function selecionarGestor(gestor) {
            elementos.gestorEliane.classList.toggle('ativo', gestor === 'eliane');
            elementos.gestorGabriel.classList.toggle('ativo', gestor === 'gabriel');
            
            if (gestor === 'eliane') {
                gestorSelecionado = 'eliane.ebarbosa@mercadolivre.com';
            } else {
                gestorSelecionado = 'gabriel.gpaiva@mercadolivre.com';
            }
            
            // Recarregar calendário com base no gestor selecionado
            carregarCalendario();
        }
        
        // VALIDAÇÃO E ABRIR POPUP
        function validarEAbrirPopup() {
            // Verificar se está em modo edição
            if (elementos.btnSolicitar.dataset.edicaoId) {
                atualizarSolicitacao(elementos.btnSolicitar.dataset.edicaoId);
                return;
            }
            
            if (!validarFormulario()) return;
            
            const solicitacao = {
                matricula: elementos.matriculaInput.value.trim(),
                nome: elementos.nomeInput.value.trim(),
                tipo: tipoSolicitacao,
                dataInicial: elementos.dataInicialInput.value,
                dataFinal: elementos.dataFinalInput.value,
                gestor: gestorSelecionado
            };
            
            // Verificar limite antes de abrir popup
            verificarLimitePeriodo(solicitacao);
        }
        
        // VERIFICAR LIMITE NO PERÍODO
        function verificarLimitePeriodo(solicitacao) {
            google.script.run
                .withSuccessHandler(function(resultado) {
                    if (resultado.excedido) {
                        // Mostrar popup de limite excedido
                        mostrarPopupLimite(resultado);
                    } else {
                        // Se não excedeu, mostrar popup de confirmação normal
                        mostrarPopupConfirmacao(solicitacao);
                    }
                })
                .withFailureHandler(function(erro) {
                    alert('Erro ao verificar limite: ' + erro.message);
                })
                .validarLimitePeriodo(solicitacao);
        }
        
        // MOSTRAR POPUP DE LIMITE EXCEDIDO
        function mostrarPopupLimite(resultado) {
            let html = `
                <p style="margin-bottom: 15px; font-size: 14px;">
                    <i class="fas fa-exclamation-triangle"></i> 
                    <strong>Limite excedido!</strong> O período solicitado excede o limite de 3 colaboradores por dia:
                </p>
                <div class="lista-colaboradores">
            `;
            
            resultado.diasExcedidos.forEach(dia => {
                const dataFormatada = new Date(dia.data).toLocaleDateString('pt-BR');
                html += `
                    <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #dee2e6;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px;">
                            <strong style="color: #dc3545;">${dataFormatada}</strong>
                            <span style="background-color: #dc3545; color: white; padding: 2px 8px; border-radius: 10px; font-size: 12px;">
                                ${dia.limite}/3
                            </span>
                        </div>
                        <div style="font-size: 12px; color: #666; margin-left: 10px;">
                            ${dia.colaboradores.map((c, i) => `${i+1}. ${c.nome} (${c.tipo})`).join('<br>')}
                        </div>
                    </div>
                `;
            });
            
            html += `
                </div>
                <div class="warning-message" style="margin-top: 15px;">
                    <i class="fas fa-lightbulb"></i> 
                    <strong>Sugestões:</strong><br>
                    1. Escolha outro período<br>
                    2. Considere agendar em feriados (ilimitado)<br>
                    3. Entre em contato com o Time de ID/EA para mais opções
                </div>
            `;
            
            elementos.popupLimiteConteudo.innerHTML = html;
            elementos.popupLimite.classList.add('active');
        }
        
        // MOSTRAR POPUP DE CONFIRMAÇÃO
        function mostrarPopupConfirmacao(solicitacao) {
            const dataInicial = new Date(solicitacao.dataInicial);
            const dataFinal = new Date(solicitacao.dataFinal);
            const diffDias = calcularDiferencaDias(dataInicial, dataFinal);
            
            const feriadosNoPeriodo = verificarFeriadosNoPeriodo(dataInicial, dataFinal);
            
            elementos.popupSummary.innerHTML = `
                <div class="summary-item">
                    <span class="summary-label">Matrícula:</span>
                    <span class="summary-value">${solicitacao.matricula}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Nome:</span>
                    <span class="summary-value">${solicitacao.nome}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Gestor:</span>
                    <span class="summary-value">${solicitacao.gestor.split('@')[0]}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Tipo:</span>
                    <span class="summary-value">${solicitacao.tipo}</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Período:</span>
                    <span class="summary-value">
                        ${formatarDataParaExibicao(dataInicial)} a ${formatarDataParaExibicao(dataFinal)}
                    </span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">Duração:</span>
                    <span class="summary-value">${diffDias} dias</span>
                </div>
                ${feriadosNoPeriodo.length > 0 ? `
                <div class="summary-item">
                    <span class="summary-label">Feriados no período:</span>
                    <span class="summary-value" style="color: #d32f2f;">
                        ${feriadosNoPeriodo.length} feriado(s)
                    </span>
                </div>
                ` : ''}
            `;
            
            elementos.popupError.innerHTML = '';
            elementos.popupError.style.display = 'none';
            elementos.popupConfirmacao.classList.add('active');
        }
        
        // ENVIAR SOLICITAÇÃO
        function enviarSolicitacao() {
            const btnOriginal = elementos.btnConfirmarEnvio.innerHTML;
            elementos.btnConfirmarEnvio.innerHTML = '<span class="loading"></span> Enviando...';
            elementos.btnConfirmarEnvio.disabled = true;
            
            const solicitacao = {
                matricula: elementos.matriculaInput.value.trim(),
                nome: elementos.nomeInput.value.trim(),
                tipo: tipoSolicitacao,
                dataInicial: elementos.dataInicialInput.value,
                dataFinal: elementos.dataFinalInput.value,
                gestor: gestorSelecionado
            };
            
            google.script.run
                .withSuccessHandler(function(resposta) {
                    elementos.btnConfirmarEnvio.innerHTML = btnOriginal;
                    elementos.btnConfirmarEnvio.disabled = false;
                    
                    if (resposta.success) {
                        elementos.popupConfirmacao.classList.remove('active');
                        
                        // Calcular dados para exibição no popup de sucesso
                        const dataInicial = new Date(solicitacao.dataInicial);
                        const dataFinal = new Date(solicitacao.dataFinal);
                        const diffDias = calcularDiferencaDias(dataInicial, dataFinal);
                        const gestorNome = solicitacao.gestor.split('@')[0].replace('.', ' ').replace(/^\w/, c => c.toUpperCase());
                        
                        elementos.sucessoInfo.innerHTML = `
                            <div class="sucesso-item">
                                <span class="sucesso-label">ID da Solicitação:</span>
                                <span class="sucesso-valor">#${resposta.id}</span>
                            </div>
                            <div class="sucesso-item">
                                <span class="sucesso-label">Matrícula:</span>
                                <span class="sucesso-valor">${solicitacao.matricula}</span>
                            </div>
                            <div class="sucesso-item">
                                <span class="sucesso-label">Nome:</span>
                                <span class="sucesso-valor">${solicitacao.nome}</span>
                            </div>
                            <div class="sucesso-item">
                                <span class="sucesso-label">Gestor:</span>
                                <span class="sucesso-valor">${gestorNome}</span>
                            </div>
                            <div class="sucesso-item">
                                <span class="sucesso-label">Tipo:</span>
                                <span class="sucesso-valor">${solicitacao.tipo}</span>
                            </div>
                            <div class="sucesso-item">
                                <span class="sucesso-label">Período:</span>
                                <span class="sucesso-valor">
                                    ${formatarDataParaExibicao(dataInicial)} a ${formatarDataParaExibicao(dataFinal)}
                                </span>
                            </div>
                            <div class="sucesso-item">
                                <span class="sucesso-label">Duração:</span>
                                <span class="sucesso-valor">${diffDias} dias</span>
                            </div>
                            <div class="sucesso-item">
                                <span class="sucesso-label">Status:</span>
                                <span class="sucesso-valor" style="color: #856404; background-color: #fff3cd; padding: 2px 8px; border-radius: 4px;">
                                    PENDENTE DE APROVAÇÃO
                                </span>
                            </div>
                        `;
                        
                        elementos.popupSucesso.classList.add('active');
                        
                        limparFormulario();
                        carregarCalendario();
                        
                        if (elementos.buscaSolicitacaoInput.value.trim() === solicitacao.matricula) {
                            buscarSolicitacoes();
                        }
                    } else {
                        elementos.popupError.innerHTML = `
                            <i class="fas fa-exclamation-circle"></i> ${resposta.message}
                        `;
                        elementos.popupError.style.display = 'block';
                    }
                })
                .withFailureHandler(function(erro) {
                    elementos.btnConfirmarEnvio.innerHTML = btnOriginal;
                    elementos.btnConfirmarEnvio.disabled = false;
                    
                    elementos.popupError.innerHTML = `
                        <i class="fas fa-exclamation-circle"></i> Erro ao enviar solicitação: ${erro.message}
                    `;
                    elementos.popupError.style.display = 'block';
                })
                .salvarSolicitacao(solicitacao);
        }
        
        // BUSCAR SOLICITAÇÕES DO USUÁRIO
        function buscarSolicitacoes() {
            const matricula = elementos.buscaSolicitacaoInput.value.trim();
            
            if (!matricula) {
                alert('Por favor, digite sua matrícula para buscar.');
                return;
            }
            
            elementos.btnBuscar.innerHTML = '<span class="loading"></span> Buscando...';
            elementos.btnBuscar.disabled = true;
            
            solicitacoesUsuario = [];
            elementos.corpoTabelaSolicitacoes.innerHTML = '';
            elementos.tabelaSolicitacoes.classList.add('hidden');
            elementos.semSolicitacoes.classList.remove('hidden');
            elementos.semSolicitacoes.innerHTML = `
                <span class="loading"></span> Buscando solicitações...
            `;
            
            google.script.run
                .withSuccessHandler(function(solicitacoes) {
                    elementos.btnBuscar.innerHTML = '<i class="fas fa-search"></i> Buscar';
                    elementos.btnBuscar.disabled = false;
                    
                    solicitacoesUsuario = solicitacoes;
                    atualizarTabelaSolicitacoes();
                })
                .withFailureHandler(function(erro) {
                    elementos.btnBuscar.innerHTML = '<i class="fas fa-search"></i> Buscar';
                    elementos.btnBuscar.disabled = false;
                    
                    elementos.semSolicitacoes.innerHTML = `
                        <i class="fas fa-exclamation-triangle" style="font-size: 48px; margin-bottom: 15px; color: #dc3545;"></i>
                        <p>Erro ao buscar solicitações: ${erro.message}</p>
                    `;
                })
                .buscarSolicitacoesPorMatricula(matricula);
        }
        
        // ATUALIZAR TABELA DE SOLICITAÇÕES
        function atualizarTabelaSolicitacoes() {
            elementos.corpoTabelaSolicitacoes.innerHTML = '';
            
            if (!solicitacoesUsuario || solicitacoesUsuario.length === 0) {
                elementos.tabelaSolicitacoes.classList.add('hidden');
                elementos.semSolicitacoes.classList.remove('hidden');
                elementos.semSolicitacoes.innerHTML = `
                    <i class="fas fa-search" style="font-size: 48px; margin-bottom: 15px; color: #ccc;"></i>
                    <p>Nenhuma solicitação encontrada para a matrícula: <strong>${elementos.buscaSolicitacaoInput.value}</strong></p>
                `;
                return;
            }
            
            elementos.semSolicitacoes.classList.add('hidden');
            elementos.tabelaSolicitacoes.classList.remove('hidden');
            
            solicitacoesUsuario.forEach(solicitacao => {
                const linha = document.createElement('tr');
                
                let dataInicialFormatada = 'N/A';
                let dataFinalFormatada = 'N/A';
                let periodo = 'Período não informado';
                
                try {
                    if (solicitacao.dataInicial) {
                        const dataInicial = new Date(solicitacao.dataInicial);
                        dataInicialFormatada = formatarDataParaExibicao(dataInicial);
                    }
                    
                    if (solicitacao.dataFinal) {
                        const dataFinal = new Date(solicitacao.dataFinal);
                        dataFinalFormatada = formatarDataParaExibicao(dataFinal);
                    }
                    
                    if (solicitacao.dataInicial && solicitacao.dataFinal) {
                        periodo = `${dataInicialFormatada} a ${dataFinalFormatada}`;
                    }
                } catch (e) {
                    periodo = 'Erro ao formatar período';
                }
                
                // Determinar gestor
                let gestorNome = 'Não informado';
                if (solicitacao.gestor) {
                    gestorNome = solicitacao.gestor.split(' ')[0]; // Primeiro nome
                }
                
                // Determinar status
                let classeStatus = '';
                let iconeStatus = '';
                let statusTexto = solicitacao.status || 'N/A';
                
                switch(statusTexto.toUpperCase()) {
                    case 'PENDENTE':
                        classeStatus = 'status-pendente';
                        iconeStatus = 'fa-clock';
                        break;
                    case 'APROVADO':
                        classeStatus = 'status-aprovado';
                        iconeStatus = 'fa-check-circle';
                        break;
                    case 'REJEITADO':
                        classeStatus = 'status-rejeitado';
                        iconeStatus = 'fa-times-circle';
                        break;
                    default:
                        classeStatus = 'status-pendente';
                        iconeStatus = 'fa-question-circle';
                }
                
                // Resolução (truncada se muito longa)
                let resolucao = solicitacao.resolucao || 'N/A';
                if (resolucao.length > 30) {
                    resolucao = resolucao.substring(0, 30) + '...';
                }
                
                // Ações (apenas para pendentes)
                let acoesHTML = '';
                if (statusTexto.toUpperCase() === 'PENDENTE') {
                    acoesHTML = `
                        <button class="btn-acao btn-editar" onclick="editarSolicitacao('${solicitacao.id}', '${solicitacao.emailGestor}')">
                            <i class="fas fa-edit"></i> Editar
                        </button>
                        <button class="btn-acao btn-excluir" onclick="excluirSolicitacao('${solicitacao.id}', '${solicitacao.emailGestor}')">
                            <i class="fas fa-trash"></i> Excluir
                        </button>
                    `;
                } else {
                    acoesHTML = '<span style="color: #777; font-style: italic;">Nenhuma ação</span>';
                }
                
                linha.innerHTML = `
                    <td><strong>${solicitacao.tipo || 'Não informado'}</strong></td>
                    <td>${periodo}</td>
                    <td>${solicitacao.quantidadeDias || 'N/A'}</td>
                    <td>
                        <span class="status ${classeStatus}">
                            <i class="fas ${iconeStatus}"></i> ${statusTexto}
                        </span>
                    </td>
                    <td title="${solicitacao.resolucao || 'Sem resolução'}">${resolucao}</td>
                    <td class="acoes">
                        <button class="btn-acao btn-editar" onclick="mostrarDetalhesSolicitacao('${solicitacao.id}')" title="Ver detalhes">
                            <i class="fas fa-eye"></i> Detalhes
                        </button>
                        ${acoesHTML}
                    </td>
                `;
                
                elementos.corpoTabelaSolicitacoes.appendChild(linha);
            });
        }
        
        // MOSTRAR DETALHES DA SOLICITAÇÃO
        window.mostrarDetalhesSolicitacao = function(id) {
            const solicitacao = solicitacoesUsuario.find(s => s.id.toString() === id.toString());
            
            if (!solicitacao) {
                alert('Solicitação não encontrada!');
                return;
            }
            
            let dataAprovacao = solicitacao.dataAprovacao || 'Não aprovada ainda';
            let resolucao = solicitacao.resolucao || 'Sem resolução registrada';
            
            let html = `
                <div class="detalhes-solicitacao">
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">ID:</span>
                        <span class="info-detalhes-valor">${solicitacao.id}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Matrícula:</span>
                        <span class="info-detalhes-valor">${solicitacao.matricula}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Nome:</span>
                        <span class="info-detalhes-valor">${solicitacao.nome}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Tipo:</span>
                        <span class="info-detalhes-valor">${solicitacao.tipo}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Período:</span>
                        <span class="info-detalhes-valor">${solicitacao.dataInicial} a ${solicitacao.dataFinal}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Dias:</span>
                        <span class="info-detalhes-valor">${solicitacao.quantidadeDias}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Gestor:</span>
                        <span class="info-detalhes-valor">${solicitacao.gestor}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Status:</span>
                        <span class="info-detalhes-valor">
                            <span class="status ${solicitacao.status === 'APROVADO' ? 'status-aprovado' : solicitacao.status === 'REJEITADO' ? 'status-rejeitado' : 'status-pendente'}">
                                ${solicitacao.status}
                            </span>
                        </span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Data Solicitação:</span>
                        <span class="info-detalhes-valor">${solicitacao.dataSolicitacao || 'N/A'}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Data Aprovação:</span>
                        <span class="info-detalhes-valor">${dataAprovacao}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Resolução:</span>
                        <span class="info-detalhes-valor">${resolucao}</span>
                    </div>
                    <div class="info-detalhes">
                        <span class="info-detalhes-label">Última Atualização:</span>
                        <span class="info-detalhes-valor">${solicitacao.ultimaAtualizacao || 'N/A'}</span>
                    </div>
                </div>
            `;
            
            elementos.popupDetalhesConteudo.innerHTML = html;
            elementos.popupDetalhes.classList.add('active');
        };
        
        // EDITAR SOLICITAÇÃO
        window.editarSolicitacao = function(id, emailGestor) {
            const solicitacao = solicitacoesUsuario.find(s => s.id.toString() === id.toString() && s.emailGestor === emailGestor);
            
            if (!solicitacao) {
                alert('Solicitação não encontrada!');
                return;
            }
            
            // Preencher formulário
            elementos.matriculaInput.value = solicitacao.matricula || '';
            elementos.nomeInput.value = solicitacao.nome || '';
            
            // Selecionar tipo
            if (solicitacao.tipo === 'Férias') {
                selecionarTipo('Férias');
            } else {
                selecionarTipo('Folga');
            }
            
            // Selecionar gestor
            if (solicitacao.emailGestor && solicitacao.emailGestor.includes('gabriel')) {
                selecionarGestor('gabriel');
            } else {
                selecionarGestor('eliane');
            }
            
            // Formatar datas corretamente
            elementos.dataInicialInput.value = formatarDataParaInput(solicitacao.dataInicial);
            elementos.dataFinalInput.value = formatarDataParaInput(solicitacao.dataFinal);
            
            // Alterar botão para edição
            elementos.btnSolicitar.innerHTML = '<i class="fas fa-save"></i> Atualizar Solicitação';
            elementos.btnSolicitar.dataset.edicaoId = id;
            elementos.btnSolicitar.dataset.emailGestor = emailGestor;
            
            // Adicionar botão cancelar edição
            elementos.areaCancelarEdicao.innerHTML = `
                <button class="btn-cancelar-edicao" id="btn-cancelar-edicao">
                    <i class="fas fa-times"></i> Cancelar Edição
                </button>
            `;
            
            document.getElementById('btn-cancelar-edicao').addEventListener('click', function() {
                limparFormulario();
            });
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
            alert('Solicitação carregada para edição. Ajuste os dados e clique em "Atualizar Solicitação".');
        };
        
        // ATUALIZAR SOLICITAÇÃO
        function atualizarSolicitacao(id) {
            if (!validarFormulario()) return;
            
            const emailGestorAtual = elementos.btnSolicitar.dataset.emailGestor;
            
            const dadosAtualizados = {
                matricula: elementos.matriculaInput.value.trim(),
                nome: elementos.nomeInput.value.trim(),
                tipo: tipoSolicitacao,
                dataInicial: elementos.dataInicialInput.value,
                dataFinal: elementos.dataFinalInput.value,
                gestor: gestorSelecionado
            };
            
            const btnOriginal = elementos.btnSolicitar.innerHTML;
            elementos.btnSolicitar.innerHTML = '<span class="loading"></span> Atualizando...';
            
            google.script.run
                .withSuccessHandler(function(resposta) {
                    elementos.btnSolicitar.innerHTML = btnOriginal;
                    
                    if (resposta.success) {
                        alert(resposta.message);
                        
                        // Restaurar botão original
                        elementos.btnSolicitar.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Solicitação';
                        delete elementos.btnSolicitar.dataset.edicaoId;
                        delete elementos.btnSolicitar.dataset.emailGestor;
                        
                        // Limpar área de cancelar edição
                        elementos.areaCancelarEdicao.innerHTML = '';
                        
                        limparFormulario();
                        buscarSolicitacoes();
                        carregarCalendario();
                    } else {
                        alert(resposta.message);
                    }
                })
                .withFailureHandler(function(erro) {
                    elementos.btnSolicitar.innerHTML = btnOriginal;
                    alert('Erro ao atualizar: ' + erro.message);
                })
                .editarSolicitacao(id, dadosAtualizados, emailGestorAtual);
        }
        
        // EXCLUIR SOLICITAÇÃO
        window.excluirSolicitacao = function(id, emailGestor) {
            if (!confirm('Tem certeza que deseja excluir esta solicitação?\n\nEsta ação não pode ser desfeita.')) {
                return;
            }
            
            google.script.run
                .withSuccessHandler(function(resposta) {
                    if (resposta.success) {
                        alert(resposta.message);
                        buscarSolicitacoes();
                        carregarCalendario();
                    } else {
                        alert(resposta.message);
                    }
                })
                .withFailureHandler(function(erro) {
                    alert('Erro ao excluir: ' + erro.message);
                })
                .excluirSolicitacao(id, emailGestor);
        };
        
        // LIMPAR FORMULÁRIO
        function limparFormulario() {
            elementos.matriculaInput.value = '';
            elementos.nomeInput.value = '';
            selecionarTipo('Folga');
            selecionarGestor('eliane');
            
            elementos.dataInicialInput.value = '';
            elementos.dataFinalInput.value = '';
            
            elementos.btnSolicitar.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Solicitação';
            delete elementos.btnSolicitar.dataset.edicaoId;
            delete elementos.btnSolicitar.dataset.emailGestor;
            
            // Limpar área de cancelar edição
            elementos.areaCancelarEdicao.innerHTML = '';
        }
        
        // VALIDAÇÃO DE DATA INICIAL
        function validarDataInicial() {
            const dataInicial = new Date(elementos.dataInicialInput.value);
            const dataFinal = new Date(elementos.dataFinalInput.value);
            const hoje = new Date(2026, 0, 1);
            
            if (!elementos.dataInicialInput.value) return;
            
            // Verificar se é pelo menos 2 dias úteis após hoje
            const diffDias = Math.ceil((dataInicial - hoje) / (1000 * 60 * 60 * 24));
            
            if (diffDias < 3) {
                alert('A solicitação deve ter no mínimo 2 dias úteis de antecedência.');
                elementos.dataInicialInput.value = '';
                return;
            }
            
            // Se já tiver data final, verificar se é maior que a inicial
            if (elementos.dataFinalInput.value && dataFinal < dataInicial) {
                alert('A data final não pode ser anterior à data inicial.');
                elementos.dataFinalInput.value = '';
            }
            
            // Ajustar período baseado no tipo
            if (elementos.dataFinalInput.value) {
                ajustarPeriodoPorTipo();
            }
        }
        
        // VALIDAÇÃO DE DATA FINAL
        function validarDataFinal() {
            if (!elementos.dataInicialInput.value) {
                alert('Selecione a data inicial primeiro.');
                elementos.dataFinalInput.value = '';
                return;
            }
            
            const dataInicial = new Date(elementos.dataInicialInput.value);
            const dataFinal = new Date(elementos.dataFinalInput.value);
            
            if (dataFinal < dataInicial) {
                alert('A data final não pode ser anterior à data inicial.');
                elementos.dataFinalInput.value = '';
                return;
            }
            
            // Ajustar período baseado no tipo
            ajustarPeriodoPorTipo();
        }
        
        // AJUSTAR PERÍODO POR TIPO
        function ajustarPeriodoPorTipo() {
            const dataInicial = new Date(elementos.dataInicialInput.value);
            const dataFinal = new Date(elementos.dataFinalInput.value);
            
            if (tipoSolicitacao === 'Folga') {
                // Máximo 7 dias para folga
                const diffDias = calcularDiferencaDias(dataInicial, dataFinal);
                if (diffDias > 7) {
                    alert('Para Folgas, o período máximo é de 7 dias. Ajustando...');
                    const novaDataFinal = new Date(dataInicial);
                    novaDataFinal.setDate(novaDataFinal.getDate() + 6);
                    elementos.dataFinalInput.value = formatarDataParaInput(novaDataFinal);
                }
            } else {
                // Mínimo 5 dias para férias
                const diffDias = calcularDiferencaDias(dataInicial, dataFinal);
                if (diffDias < 5) {
                    alert('Para Férias, o período mínimo é de 5 dias. Ajustando...');
                    const novaDataFinal = new Date(dataInicial);
                    novaDataFinal.setDate(novaDataFinal.getDate() + 4);
                    elementos.dataFinalInput.value = formatarDataParaInput(novaDataFinal);
                }
            }
        }
        
        // VALIDAÇÃO DE FORMULÁRIO
        function validarFormulario() {
            if (!elementos.matriculaInput.value.trim()) {
                alert('Por favor, preencha sua matrícula.');
                elementos.matriculaInput.focus();
                return false;
            }
            
            if (!elementos.nomeInput.value.trim()) {
                alert('Por favor, preencha seu nome completo.');
                elementos.nomeInput.focus();
                return false;
            }
            
            if (!elementos.dataInicialInput.value) {
                alert('Por favor, selecione a data inicial.');
                elementos.dataInicialInput.focus();
                return false;
            }
            
            if (!elementos.dataFinalInput.value) {
                alert('Por favor, selecione a data final.');
                elementos.dataFinalInput.focus();
                return false;
            }
            
            const dataInicial = new Date(elementos.dataInicialInput.value);
            const hoje = new Date(2026, 0, 1);
            const diffDias = Math.ceil((dataInicial - hoje) / (1000 * 60 * 60 * 24));
            
            if (diffDias < 3) {
                alert('A solicitação deve ter no mínimo 2 dias úteis de antecedência.');
                return false;
            }
            
            return true;
        }
        
        // CARREGAR CALENDÁRIO COM FERIADOS
        function carregarCalendario() {
            const ano = dataAtual.getFullYear();
            const mes = dataAtual.getMonth();
            
            const meses = [
                'Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho',
                'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'
            ];
            elementos.mesAtualElement.textContent = `${meses[mes]} ${ano}`;
            
            elementos.calendarioElement.innerHTML = '';
            
            const primeiroDia = new Date(ano, mes, 1);
            const ultimoDia = new Date(ano, mes + 1, 0);
            const diaDaSemana = primeiroDia.getDay();
            
            // Dias vazios antes do primeiro dia
            for (let i = 0; i < diaDaSemana; i++) {
                const diaVazio = document.createElement('div');
                diaVazio.classList.add('dia');
                diaVazio.style.visibility = 'hidden';
                elementos.calendarioElement.appendChild(diaVazio);
            }
            
            // Carregar feriados do mês
            carregarFeriadosDoMes(ano, mes + 1);
            
            // Carregar colaboradores para cada dia
            for (let dia = 1; dia <= ultimoDia.getDate(); dia++) {
                const data = new Date(ano, mes, dia);
                criarDiaCalendario(data, dia);
            }
        }
        
        // CRIAR DIA NO CALENDÁRIO
        function criarDiaCalendario(data, numeroDia) {
            const diaElement = document.createElement('div');
            diaElement.classList.add('dia');
            diaElement.textContent = numeroDia;
            
            const dataFormatada = formatarDataParaInput(data);
            
            // Verificar se é feriado
            const feriado = feriadosDoMes.find(f => f.data === dataFormatada);
            if (feriado) {
                if (feriado.tipo === 'Nacional') {
                    diaElement.classList.add('dia-nacional');
                    diaElement.title = `🏛️ ${feriado.nome} (Nacional)`;
                } else {
                    diaElement.classList.add('dia-municipal');
                    diaElement.title = `🏙️ ${feriado.nome} (Cajamar-SP)`;
                }
            }
            
            // Verificar se é final de semana
            const diaSemana = data.getDay();
            if (diaSemana === 0 || diaSemana === 6) {
                if (!feriado) {
                    diaElement.classList.add('feriado');
                    diaElement.title = '🏠 Final de semana';
                }
            }
            
            // Verificar se é dia atual (01/01/2026)
            if (data.getFullYear() === 2026 && data.getMonth() === 0 && data.getDate() === 1) {
                diaElement.classList.add('atual');
                diaElement.title = (diaElement.title ? diaElement.title + '\n' : '') + '📅 Dia atual';
            }
            
            // Carregar colaboradores deste dia
            carregarColaboradoresDoDia(dataFormatada, diaElement, feriado);
            
            // Adicionar evento de clique
            diaElement.addEventListener('click', function() {
                mostrarDetalhesDia(data, feriado);
            });
            
            elementos.calendarioElement.appendChild(diaElement);
        }
        
        // CARREGAR COLABORADORES DO DIA
        function carregarColaboradoresDoDia(dataFormatada, diaElement, feriado) {
            google.script.run
                .withSuccessHandler(function(colaboradores) {
                    // Filtrar por gestor selecionado
                    const colaboradoresFiltrados = colaboradores.filter(colab => {
                        return colab.gestor.includes(gestorSelecionado.includes('eliane') ? 'Eliane' : 'Gabriel');
                    });
                    
                    if (colaboradoresFiltrados.length > 0) {
                        diaElement.classList.add('com-colaboradores');
                        
                        // Mostrar primeiro nome do primeiro colaborador
                        if (colaboradoresFiltrados[0].nome) {
                            const primeiroNome = colaboradoresFiltrados[0].nome.split(' ')[0];
                            const nomeElement = document.createElement('div');
                            nomeElement.className = 'nome-colaborador';
                            nomeElement.textContent = primeiroNome;
                            diaElement.appendChild(nomeElement);
                            
                            // Adicionar outros nomes como tooltip
                            const outrosNomes = colaboradoresFiltrados.slice(1, 3).map(c => 
                                c.nome.split(' ')[0]
                            ).join(', ');
                            
                            if (outrosNomes) {
                                diaElement.title = (diaElement.title ? diaElement.title + '\n\n' : '') + 
                                                  `👥 Colaboradores: ${primeiroNome}, ${outrosNomes}`;
                            } else {
                                diaElement.title = (diaElement.title ? diaElement.title + '\n\n' : '') + 
                                                  `👥 Colaborador: ${primeiroNome}`;
                            }
                        }
                        
                        // Adicionar contador
                        const contador = document.createElement('div');
                        contador.className = 'contador-dia';
                        contador.textContent = colaboradoresFiltrados.length;
                        diaElement.appendChild(contador);
                        
                        // Verificar se atingiu limite (apenas se não for feriado)
                        if (colaboradoresFiltrados.length >= 3 && !feriado) {
                            diaElement.classList.add('limite-atingido');
                        }
                    }
                    
                    colaboradoresPorData[dataFormatada] = colaboradoresFiltrados;
                })
                .withFailureHandler(function(erro) {
                    console.error('Erro ao carregar colaboradores:', erro);
                })
                .getColaboradoresPorData(dataFormatada, gestorSelecionado);
        }
        
        // MOSTRAR DETALHES DO DIA
        function mostrarDetalhesDia(data, feriado) {
            const dataFormatada = formatarDataParaExibicao(data);
            const dataKey = formatarDataParaInput(data);
            const colaboradores = colaboradoresPorData[dataKey] || [];
            
            let mensagem = `📅 ${dataFormatada}\n\n`;
            
            if (feriado) {
                const icone = feriado.tipo === 'Nacional' ? '🏛️' : '🏙️';
                mensagem += `${icone} ${feriado.nome} (${feriado.tipo})\n\n`;
            }
            
            if (colaboradores.length > 0) {
                mensagem += `👥 Colaboradores agendados (${colaboradores.length}/3):\n`;
                colaboradores.forEach((colab, index) => {
                    const status = colab.status === 'PENDENTE' ? '⏳ Pendente' : '✅ Aprovado';
                    const primeiroNome = colab.nome.split(' ')[0];
                    mensagem += `${index + 1}. ${primeiroNome} - ${colab.tipo} (${status})\n`;
                });
            } else {
                mensagem += `👥 Nenhum colaborador agendado\n`;
            }
            
            if (feriado) {
                mensagem += `\n🎯 Feriado: agendamento ilimitado permitido`;
            } else {
                const limiteAtingido = colaboradores.length >= 3;
                mensagem += `\n📊 Limite: ${colaboradores.length}/3 colaboradores`;
                if (limiteAtingido) {
                    mensagem += ` ❌ LIMITE ATINGIDO`;
                }
            }
            
            alert(mensagem);
        }
        
        // CARREGAR FERIADOS DO MÊS
        function carregarFeriadosDoMes(ano, mes) {
            google.script.run
                .withSuccessHandler(function(feriados) {
                    feriadosDoMes = feriados;
                    atualizarListaFeriados();
                })
                .withFailureHandler(function(erro) {
                    console.error('Erro ao carregar feriados:', erro);
                })
                .getFeriadosPorMes(ano, mes);
        }
        
        // ATUALIZAR LISTA DE FERIADOS
        function atualizarListaFeriados() {
            if (feriadosDoMes.length === 0) {
                elementos.feriadosMes.style.display = 'none';
                return;
            }
            
            elementos.feriadosMes.style.display = 'block';
            elementos.listaFeriados.innerHTML = '';
            
            feriadosDoMes.forEach(feriado => {
                const data = new Date(feriado.data);
                const dataFormatada = formatarDataParaExibicao(data);
                
                const item = document.createElement('div');
                item.className = 'feriado-item';
                
                const cor = document.createElement('div');
                cor.className = `feriado-cor ${feriado.tipo === 'Nacional' ? 'cor-nacional' : 'cor-municipal'}`;
                
                const texto = document.createElement('span');
                texto.textContent = `${dataFormatada}: ${feriado.nome}`;
                
                item.appendChild(cor);
                item.appendChild(texto);
                elementos.listaFeriados.appendChild(item);
            });
        }
        
        // VERIFICAR FERIADOS NO PERÍODO
        function verificarFeriadosNoPeriodo(dataInicial, dataFinal) {
            const feriados = [];
            const inicio = new Date(dataInicial);
            const fim = new Date(dataFinal);
            
            for (let data = new Date(inicio); data <= fim; data.setDate(data.getDate() + 1)) {
                const dataFormatada = formatarDataParaInput(data);
                const feriado = feriadosDoMes.find(f => f.data === dataFormatada);
                if (feriado) {
                    feriados.push(`${feriado.nome} (${feriado.tipo})`);
                }
            }
            
            return feriados;
        }
        
        // FUNÇÕES AUXILIARES
        function formatarDataParaInput(data) {
            if (!data) return '';
            try {
                const dataObj = data instanceof Date ? data : new Date(data);
                const ano = dataObj.getFullYear();
                const mes = String(dataObj.getMonth() + 1).padStart(2, '0');
                const dia = String(dataObj.getDate()).padStart(2, '0');
                return `${ano}-${mes}-${dia}`;
            } catch (e) {
                // Se for string no formato dd/MM/yyyy
                if (typeof data === 'string' && data.includes('/')) {
                    const partes = data.split('/');
                    if (partes.length === 3) {
                        return `${partes[2]}-${partes[1]}-${partes[0]}`;
                    }
                }
                return data || '';
            }
        }
        
        function formatarDataParaExibicao(data) {
            if (!data) return 'N/A';
            try {
                const dataObj = data instanceof Date ? data : new Date(data);
                return dataObj.toLocaleDateString('pt-BR');
            } catch (e) {
                return 'Data inválida';
            }
        }
        
        function calcularDiferencaDias(dataInicio, dataFim) {
            try {
                const inicio = dataInicio instanceof Date ? dataInicio : new Date(dataInicio);
                const fim = dataFim instanceof Date ? dataFim : new Date(dataFim);
                const diffTime = Math.abs(fim - inicio);
                return Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
            } catch (e) {
                return 0;
            }
        }
    </script>
</body>
</html>
